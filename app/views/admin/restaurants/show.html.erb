<div class="admin-dashboard">
  <div class="restaurant-header">
    <div>
      <p class="hero-kicker">Restaurante</p>
      <h1><%= @restaurant.name %></h1>
      <p class="text-muted"><%= @restaurant.address.presence || "Direccion pendiente" %></p>
    </div>
  </div>

  <div class="stat-grid">
    <div class="stat-card">
      <h3><%= @upcoming_reservations.count %></h3>
      <p>Reservas proximas</p>
    </div>
    <div class="stat-card">
      <h3><%= @pending_reservations.count %></h3>
      <p>Pendientes de confirmar</p>
    </div>
    <div class="stat-card">
      <h3><%= @restaurant.menu_file.attached? ? "Sí" : "No" %></h3>
      <p>Menú cargado</p>
    </div>
  </div>

  <div class="dashboard-grid">
    <div class="module-card">
      <h2>Operacion del dia</h2>
      <p class="text-muted">Control rapido de reservas y disponibilidad.</p>
      <div class="status-row">
        <span class="badge badge-pending">Pendientes: <%= @pending_reservations.count %></span>
        <span class="badge badge-confirmed">Confirmadas: <%= @restaurant.reservations.confirmed.count %></span>
        <span class="badge badge-completed">Completadas: <%= @restaurant.reservations.completed.count %></span>
        <span class="badge badge-cancelled">Canceladas: <%= @restaurant.reservations.where(status: "cancelled").count %></span>
      </div>
    </div>

    <div class="module-card">
      <h2>Perfil del restaurante</h2>
      <p class="text-muted">Mantener la informacion al dia mejora la conversion.</p>
      <div class="info-grid">
        <div>
          <span class="label">Horario</span>
          <p class="value">
            <% if @restaurant.open_time && @restaurant.close_time %>
              <%= @restaurant.open_time.strftime("%H:%M") %> - <%= @restaurant.close_time.strftime("%H:%M") %>
            <% else %>
              N/A
            <% end %>
          </p>
        </div>
        <div>
          <span class="label">Telefono</span>
          <p class="value"><%= @restaurant.phone_number.presence || "N/A" %></p>
        </div>
        <div>
          <span class="label">Aforo maximo</span>
          <p class="value">
            <%= @restaurant.max_capacity.to_i.positive? ? "#{@restaurant.max_capacity} personas" : "N/A" %>
          </p>
        </div>
        <div>
          <span class="label">Reservas</span>
          <p class="value"><%= @restaurant.reservations_enabled? ? "Habilitadas" : "Deshabilitadas" %></p>
        </div>
      </div>
    </div>

    <div class="module-card">
      <h2>Suscripcion</h2>
      <% latest = @restaurant.subscriptions.order(created_at: :desc).first %>
      <% if latest.present? && latest.status == 'active' %>
        <p class="text-muted">Tu plan esta activo.</p>
        <span class="badge badge-success">Activa</span>
      <% else %>
        <p class="text-muted">Activa la suscripcion para acceder a funciones premium.</p>
        <%= link_to "Activar suscripcion ($15/mes)", new_admin_restaurant_subscription_path(@restaurant), class: "btn btn-primary" %>
      <% end %>
    </div>
  </div>
</div>
